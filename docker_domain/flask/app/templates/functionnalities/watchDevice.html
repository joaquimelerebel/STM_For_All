{% extends "./menuToolkitTemplate.html" %} {% block mainpage %}

<div class="coldisp">
  <h2 class="title">Flow output</h2>
  <div class="container">
    <div style="margin-top: 2% !important; margin: auto; text-align: center">
      {% if path%}
      <div class="lightgray fit">
        <img
          id="dyn_img"
          class="img-fluid"
          src="{{ url_for('static', filename='img/results' + path) }}"
          style="margintop: 2%"
          alt="Lacking image - Result of computation"
        />
        <button id="scan_launch" class="btn btn-primary" type="button">launch scan</button>
      </div>
      {% else %}
      <h4>No flow</h4>
      <button id="scan_launch" class="btn btn-primary" type="button">launch scan</button>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %} {% block options %} {% include './options/menuOptionsInfo.html'
%} {% endblock %} {% block toolkit %} {% include './options/toolkit.html' %} {%
endblock %}

{%block body_script%}
<script type="text/javascript">
  $(document).ready( function(){
    var socket = io();
    
    socket.on("connection", socket => {
      socket.join("{{path}}");
    });

    socket.connect();



    socket.on("update_img", function( path ){
      $("#dyn_img").attr('src', path + "?" + new Date().getTime());
    });

    $("#scan_launch").on("click", function () {
          socket.emit("launch_scan");
          $("#scan_launch").remove();
    });
  });

</script>
{%endblock%}
